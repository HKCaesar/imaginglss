<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>model.utils.sharedmem package &mdash; ImagingLSS 0.9 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ImagingLSS 0.9 documentation" href="index.html" />
    <link rel="up" title="model.utils package" href="model.utils.html" />
    <link rel="prev" title="model.utils package" href="model.utils.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="model.utils.html" title="model.utils package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ImagingLSS 0.9 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="model.html" >model package</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="model.utils.html" accesskey="U">model.utils package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="model-utils-sharedmem-package">
<h1>model.utils.sharedmem package<a class="headerlink" href="#model-utils-sharedmem-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-model.utils.sharedmem.backends">
<span id="model-utils-sharedmem-backends-module"></span><h2>model.utils.sharedmem.backends module<a class="headerlink" href="#module-model.utils.sharedmem.backends" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="model.utils.sharedmem.backends.set_debug">
<code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">set_debug</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#set_debug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.set_debug" title="Permalink to this definition">¶</a></dt>
<dd><p>in debug mode (flag==True), no slaves are spawn,
rather all work are done in serial on the master thread/process.
so that if the worker throws out exceptions, debugging from the main
process context is possible. (in iptyhon, with debug magic command, eg)</p>
</dd></dl>

<dl class="function">
<dt id="model.utils.sharedmem.backends.get_debug">
<code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">get_debug</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#get_debug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.get_debug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="model.utils.sharedmem.backends.total_memory">
<code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">total_memory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#total_memory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.total_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>the amount of memory available for use.
default is the Free Memory entry in /proc/meminfo</p>
</dd></dl>

<dl class="function">
<dt id="model.utils.sharedmem.backends.cpu_count">
<code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">cpu_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#cpu_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.cpu_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The cpu count defaults to the number of physical cpu cores
but can be set with OMP_NUM_THREADS environment variable.
OMP_NUM_THREADS is used because if you hybrid sharedmem with
some openMP extenstions one environment will do it all.</p>
<p>On PBS/torque systems if OMP_NUM_THREADS is empty, we try to
use the value of PBS_NUM_PPN variable.</p>
<p>on some machines the physical number of cores does not equal
the number of cpus shall be used. PSC Blacklight for example.</p>
<p>Pool defaults to use cpu_count() slaves. however it can be overridden
in Pool.</p>
</dd></dl>

<dl class="class">
<dt id="model.utils.sharedmem.backends.ThreadBackend">
<em class="property">class </em><code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">ThreadBackend</code><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ThreadBackend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ThreadBackend" title="Permalink to this definition">¶</a></dt>
<dd><dl class="staticmethod">
<dt id="model.utils.sharedmem.backends.ThreadBackend.EventFactory">
<em class="property">static </em><code class="descname">EventFactory</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#model.utils.sharedmem.backends.ThreadBackend.EventFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>A factory function that returns a new event.</p>
<p>Events manage a flag that can be set to true with the set() method and reset
to false with the clear() method. The wait() method blocks until the flag is
true.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="model.utils.sharedmem.backends.ThreadBackend.LockFactory">
<em class="property">static </em><code class="descname">LockFactory</code><span class="sig-paren">(</span><em>) -&gt; lock object (allocate() is an obsolete synonym</em><span class="sig-paren">)</span><a class="headerlink" href="#model.utils.sharedmem.backends.ThreadBackend.LockFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new lock object.  See help(LockType) for information about locks.</p>
</dd></dl>

<dl class="attribute">
<dt id="model.utils.sharedmem.backends.ThreadBackend.QueueFactory">
<code class="descname">QueueFactory</code><a class="headerlink" href="#model.utils.sharedmem.backends.ThreadBackend.QueueFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">Queue</span></code></p>
</dd></dl>

<dl class="staticmethod">
<dt id="model.utils.sharedmem.backends.ThreadBackend.SlaveFactory">
<em class="property">static </em><code class="descname">SlaveFactory</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ThreadBackend.SlaveFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ThreadBackend.SlaveFactory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="model.utils.sharedmem.backends.ThreadBackend.StorageFactory">
<code class="descname">StorageFactory</code><a class="headerlink" href="#model.utils.sharedmem.backends.ThreadBackend.StorageFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">_local</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="model.utils.sharedmem.backends.ProcessBackend">
<em class="property">class </em><code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">ProcessBackend</code><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessBackend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessBackend" title="Permalink to this definition">¶</a></dt>
<dd><dl class="staticmethod">
<dt id="model.utils.sharedmem.backends.ProcessBackend.EventFactory">
<em class="property">static </em><code class="descname">EventFactory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessBackend.EventFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an event object</p>
</dd></dl>

<dl class="staticmethod">
<dt id="model.utils.sharedmem.backends.ProcessBackend.LockFactory">
<em class="property">static </em><code class="descname">LockFactory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessBackend.LockFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a non-recursive lock object</p>
</dd></dl>

<dl class="staticmethod">
<dt id="model.utils.sharedmem.backends.ProcessBackend.QueueFactory">
<em class="property">static </em><code class="descname">QueueFactory</code><span class="sig-paren">(</span><em>maxsize=0</em><span class="sig-paren">)</span><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessBackend.QueueFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a queue object</p>
</dd></dl>

<dl class="staticmethod">
<dt id="model.utils.sharedmem.backends.ProcessBackend.SlaveFactory">
<em class="property">static </em><code class="descname">SlaveFactory</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessBackend.SlaveFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessBackend.SlaveFactory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="model.utils.sharedmem.backends.ProcessBackend.StorageFactory">
<em class="property">static </em><code class="descname">StorageFactory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessBackend.StorageFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessBackend.StorageFactory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="exception">
<dt id="model.utils.sharedmem.backends.SlaveException">
<em class="property">exception </em><code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">SlaveException</code><span class="sig-paren">(</span><em>e</em>, <em>tracebackstr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#SlaveException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.SlaveException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="model.utils.sharedmem.backends.StopProcessGroup">
<em class="property">exception </em><code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">StopProcessGroup</code><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#StopProcessGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.StopProcessGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>StopProcessGroup will terminate the slave process/thread</p>
</dd></dl>

<dl class="class">
<dt id="model.utils.sharedmem.backends.ProcessGroup">
<em class="property">class </em><code class="descclassname">model.utils.sharedmem.backends.</code><code class="descname">ProcessGroup</code><span class="sig-paren">(</span><em>backend</em>, <em>main</em>, <em>np</em>, <em>args=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="model.utils.sharedmem.backends.ProcessGroup.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>Q</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessGroup.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessGroup.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Protected get. Get an item from Q.
Will block. but if the process group has errors,
raise an StopProcessGroup exception.</p>
<p>A slave process will terminate upon StopProcessGroup.
The master process shall read the error</p>
</dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.backends.ProcessGroup.get_exception">
<code class="descname">get_exception</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessGroup.get_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessGroup.get_exception" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.backends.ProcessGroup.is_alive">
<code class="descname">is_alive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessGroup.is_alive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessGroup.is_alive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.backends.ProcessGroup.join">
<code class="descname">join</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessGroup.join"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessGroup.join" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.backends.ProcessGroup.killall">
<code class="descname">killall</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessGroup.killall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessGroup.killall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.backends.ProcessGroup.put">
<code class="descname">put</code><span class="sig-paren">(</span><em>Q</em>, <em>item</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessGroup.put"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessGroup.put" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.backends.ProcessGroup.start">
<code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/backends.html#ProcessGroup.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.backends.ProcessGroup.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-model.utils.sharedmem.background">
<span id="model-utils-sharedmem-background-module"></span><h2>model.utils.sharedmem.background module<a class="headerlink" href="#module-model.utils.sharedmem.background" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="model.utils.sharedmem.background.background">
<em class="property">class </em><code class="descclassname">model.utils.sharedmem.background.</code><code class="descname">background</code><span class="sig-paren">(</span><em>function</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/background.html#background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.background.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>to run a function in async with a process.</p>
<dl class="docutils">
<dt>def function(<a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs):</dt>
<dd>pass</dd>
</dl>
<p>bg = background(function, <a href="#id5"><span class="problematic" id="id6">*</span></a>args, <a href="#id7"><span class="problematic" id="id8">**</span></a>kwargs)</p>
<p>rt = bg.wait()</p>
<dl class="method">
<dt id="model.utils.sharedmem.background.background.closure">
<code class="descname">closure</code><span class="sig-paren">(</span><em>function</em>, <em>args</em>, <em>kwargs</em>, <em>result</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/background.html#background.closure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.background.background.closure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.background.background.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/background.html#background.wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.background.background.wait" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-model.utils.sharedmem.mapreduce">
<span id="model-utils-sharedmem-mapreduce-module"></span><h2>model.utils.sharedmem.mapreduce module<a class="headerlink" href="#module-model.utils.sharedmem.mapreduce" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="model.utils.sharedmem.mapreduce.MapReduce">
<em class="property">class </em><code class="descclassname">model.utils.sharedmem.mapreduce.</code><code class="descname">MapReduce</code><span class="sig-paren">(</span><em>backend=&lt;class model.utils.sharedmem.backends.ProcessBackend at 0x20c6460&gt;</em>, <em>np=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/mapreduce.html#MapReduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.mapreduce.MapReduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="model.utils.sharedmem.mapreduce.MapReduce.main">
<code class="descname">main</code><span class="sig-paren">(</span><em>pg</em>, <em>Q</em>, <em>R</em>, <em>sequence</em>, <em>realfunc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/mapreduce.html#MapReduce.main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.mapreduce.MapReduce.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.mapreduce.MapReduce.map">
<code class="descname">map</code><span class="sig-paren">(</span><em>func</em>, <em>sequence</em>, <em>reduce=None</em>, <em>star=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/mapreduce.html#MapReduce.map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.mapreduce.MapReduce.map" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="model.utils.sharedmem.mapreduce.MapReduceByThread">
<code class="descclassname">model.utils.sharedmem.mapreduce.</code><code class="descname">MapReduceByThread</code><span class="sig-paren">(</span><em>np=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/mapreduce.html#MapReduceByThread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.mapreduce.MapReduceByThread" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-model.utils.sharedmem.memory">
<span id="model-utils-sharedmem-memory-module"></span><h2>model.utils.sharedmem.memory module<a class="headerlink" href="#module-model.utils.sharedmem.memory" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="model.utils.sharedmem.memory.empty">
<code class="descclassname">model.utils.sharedmem.memory.</code><code class="descname">empty</code><span class="sig-paren">(</span><em>shape</em>, <em>dtype='f8'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/memory.html#empty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.memory.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>allocates an empty array on the shared memory</p>
</dd></dl>

<dl class="function">
<dt id="model.utils.sharedmem.memory.empty_like">
<code class="descclassname">model.utils.sharedmem.memory.</code><code class="descname">empty_like</code><span class="sig-paren">(</span><em>array</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/memory.html#empty_like"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.memory.empty_like" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="model.utils.sharedmem.memory.copy">
<code class="descclassname">model.utils.sharedmem.memory.</code><code class="descname">copy</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/memory.html#copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.memory.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>copies an array to the shared memory, use
a = copy(a) to immediately dereference the old &#8216;a&#8217; on private memory</p>
</dd></dl>

</div>
<div class="section" id="module-model.utils.sharedmem.parallel">
<span id="model-utils-sharedmem-parallel-module"></span><h2>model.utils.sharedmem.parallel module<a class="headerlink" href="#module-model.utils.sharedmem.parallel" title="Permalink to this headline">¶</a></h2>
<p>OpenMP like multiprocessing</p>
<p>Example:</p>
<blockquote>
<div><dl class="docutils">
<dt>with Parallel(</dt>
<dd><blockquote class="first">
<div>Reduction(numpy.add, a=[0, 0])
) as p:</div></blockquote>
<dl class="last docutils">
<dt>for i, ordered in p.forloop(range(20), </dt>
<dd><blockquote class="first">
<div>ordered=True, schedule=&#8217;dynamic&#8217;):</div></blockquote>
<dl class="last docutils">
<dt>with ordered:</dt>
<dd><p class="first">p.var.a += numpy.array([i, i * 10])
if i == 19:</p>
<blockquote class="last">
<div>raise ValueError(&#8216;raised at i == 19&#8217;)</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p>1 All variables are by default &#8216;Private&#8217;: this differ from OpenMP</p>
<p>2 To access variables defined for the Parallel scope, use p.var</p>
<dl class="docutils">
<dt>3 This is too slow to be useful as I can imagine. </dt>
<dd>Looping in Python is horriblly slow as we know it
and we use iterators to yield values, plus slow posix semaphores.</dd>
<dt>4 forloop returns the iterator for the variable if ordered == False</dt>
<dd>forloop returns the iterator variable and an Ordered object if
ordered==True.</dd>
<dt>5 DeadLocks: </dt>
<dd><p class="first">Tested pretty extensively, but 
there still may be some corner cases.</p>
<p>Biggest bunch I have fixed are because we rely on
an asynchronized Exception(AE) to jump out of a parallel scope
when there are exceptions from slave processes.
In Python AE is unsafe, even with the new &#8216;with&#8217; statement.</p>
<p class="last">As a fix, we limit the AE only between __enter__ and __exit__,
and the only nontrivial object used is Semaphore. In case of
unprotected and failed Semaphore release, we release them one
more time from another thread, guareenteed to be safe from 
the AE we use (signal AE)</p>
</dd>
</dl>
<p>Comparing similiar features between Parallel and OpenMP standard:</p>
<blockquote>
<div><p>Parallel               vs  openmp construct</p>
<dl class="docutils">
<dt>with Parallel() as p:           omp parallel </dt>
<dd><p class="first">xxxx
p.rank                      omp_get_thread_num()
p.num_threads               omp_get_num_threads()</p>
<dl class="docutils">
<dt>p.var.a:                    a referes to the variable &#8216;a&#8217; </dt>
<dd>decleared with Private, Shared or Reduction</dd>
<dt>if p.master:                    omp master </dt>
<dd>xxxx</dd>
<dt>for i in p.forloop():           omp for</dt>
<dd>xxxxj</dd>
</dl>
<p>p.barrier()                       omp barrier</p>
<p>r = p.forloop(ordered=True)     omp for
for i in r:</p>
<blockquote>
<div><dl class="docutils">
<dt>with r.ordered:              omp ordered</dt>
<dd>xxxx</dd>
</dl>
</div></blockquote>
<dl class="last docutils">
<dt>with p.critical:                 omp critical</dt>
<dd>xxxx</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="class">
<dt id="model.utils.sharedmem.parallel.Parallel">
<em class="property">class </em><code class="descclassname">model.utils.sharedmem.parallel.</code><code class="descname">Parallel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/parallel.html#Parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.parallel.Parallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="docutils">
<dt><a href="#id9"><span class="problematic" id="id10">**</span></a>kwargs: </dt>
<dd>num_threads: number of processes (default to OMP_NUM_THREADS)</dd>
<dt><a href="#id11"><span class="problematic" id="id12">*</span></a>args:</dt>
<dd>Private(name=value, ....)
Shared(name=value, ....)
Reduction(ufunc, name=value, ....)</dd>
</dl>
<dl class="method">
<dt id="model.utils.sharedmem.parallel.Parallel.barrier">
<code class="descname">barrier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/parallel.html#Parallel.barrier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.parallel.Parallel.barrier" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="model.utils.sharedmem.parallel.Parallel.forloop">
<code class="descname">forloop</code><span class="sig-paren">(</span><em>range</em>, <em>ordered=False</em>, <em>schedule=('static'</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/parallel.html#Parallel.forloop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.parallel.Parallel.forloop" title="Permalink to this definition">¶</a></dt>
<dd><p>schedule can be
(sch, chunk) or sch;
sch is &#8216;static&#8217;, &#8216;dynamic&#8217; or &#8216;guided&#8217;.</p>
<p>chunk defaults to 1</p>
<p>if ordered, create an ordred</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="model.utils.sharedmem.parallel.ParallelException">
<em class="property">exception </em><code class="descclassname">model.utils.sharedmem.parallel.</code><code class="descname">ParallelException</code><a class="reference internal" href="_modules/model/utils/sharedmem/parallel.html#ParallelException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.parallel.ParallelException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>When a Slave process is unexpectedly killed (by the OS, eg, OOM)</p>
</dd></dl>

</div>
<div class="section" id="module-model.utils.sharedmem.pool">
<span id="model-utils-sharedmem-pool-module"></span><h2>model.utils.sharedmem.pool module<a class="headerlink" href="#module-model.utils.sharedmem.pool" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="model.utils.sharedmem.pool.Pool">
<em class="property">class </em><code class="descclassname">model.utils.sharedmem.pool.</code><code class="descname">Pool</code><span class="sig-paren">(</span><em>np=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/pool.html#Pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.pool.Pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.utils.sharedmem.mapreduce.MapReduce" title="model.utils.sharedmem.mapreduce.MapReduce"><code class="xref py py-class docutils literal"><span class="pre">model.utils.sharedmem.mapreduce.MapReduce</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="model.utils.sharedmem.pool.TPool">
<em class="property">class </em><code class="descclassname">model.utils.sharedmem.pool.</code><code class="descname">TPool</code><span class="sig-paren">(</span><em>np=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model/utils/sharedmem/pool.html#TPool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model.utils.sharedmem.pool.TPool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.utils.sharedmem.mapreduce.MapReduce" title="model.utils.sharedmem.mapreduce.MapReduce"><code class="xref py py-class docutils literal"><span class="pre">model.utils.sharedmem.mapreduce.MapReduce</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-model.utils.sharedmem">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-model.utils.sharedmem" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">model.utils.sharedmem package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-model.utils.sharedmem.backends">model.utils.sharedmem.backends module</a></li>
<li><a class="reference internal" href="#module-model.utils.sharedmem.background">model.utils.sharedmem.background module</a></li>
<li><a class="reference internal" href="#module-model.utils.sharedmem.mapreduce">model.utils.sharedmem.mapreduce module</a></li>
<li><a class="reference internal" href="#module-model.utils.sharedmem.memory">model.utils.sharedmem.memory module</a></li>
<li><a class="reference internal" href="#module-model.utils.sharedmem.parallel">model.utils.sharedmem.parallel module</a></li>
<li><a class="reference internal" href="#module-model.utils.sharedmem.pool">model.utils.sharedmem.pool module</a></li>
<li><a class="reference internal" href="#module-model.utils.sharedmem">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="model.utils.html"
                        title="previous chapter">model.utils package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/model.utils.sharedmem.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="model.utils.html" title="model.utils package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ImagingLSS 0.9 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="model.html" >model package</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="model.utils.html" >model.utils package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Yu Feng, Martin White.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.
    </div>
  </body>
</html>